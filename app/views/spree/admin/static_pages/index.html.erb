<% content_for :page_title do %>
  <%= t("simple_cms.page.listing_pages") %>
<% end %>

<% content_for :page_actions do %>
<div class="toolbar" data-hook="toolbar">
	<ul class="actions header-action-links inline-menu">
      	<li id="new_page_link">
			<%= button_link_to t("simple_cms.page.new_page"), new_object_url, { :remote => true, :icon => 'icon-plus', :id => 'admin_new_page_link' } %>
		</li>
	</ul>
	<br class="clear" />
</div>
<% end %>

<div id="new_page" data-hook></div>

<table class="index sortable" id="listing_pages" data-hook data-hook data-sortable-link="<%= update_positions_admin_static_pages_url %>">
	<thead>
		<tr data-hook="admin_pages_index_headers">
			<th><%= sort_link @search,:name, t(:page), {}, {:title => t("simple_cms.page.name")} %></th>
			<th><%= t(:position) %></th>
			<th><%= t(:in_nav_menu) %></th>
			<th><%= t(:published_at) %></th>
			<th data-hook="admin_static_pages_index_header_actions"><%= t(:action) %></th>
		</tr>
	</thead>
	<tbody>
		<% @static_pages.each do |sp|%>
		<tr id="<%= dom_id sp %>" data-hook="admin_static_pages_index_rows">
			<td width="270px" class='page_name'>
				<span class="handle"></span>
				<%= sp.name %>
			</td>
			<td class="static_page_position"><%= sp.position %></td>
			<td class="static_page_position"><%= sp.in_nav_menu %></td>
			<td width="80px" class='page_published_at'><%= l(sp.published_at, :format => :short) rescue "" %></td>
			<td data-hook="admin_pages_index_row_actions">
				<%= link_to_edit sp, :class => 'edit' %> &nbsp;
				<%= link_to_delete sp %>
				<% unless sp.published? %>
				<%= link_to_with_icon 'tick', t('published'), {:action => 'published', :id => sp.id} %>
				<% end %>
				<% if (sp.in_nav_menu.blank? || sp.in_nav_menu != 1) %>
				<%= link_to_with_icon 'tick', t('in_nav_menu'), {:action => 'in_nav_menu', :id => sp.id} %>
				<% end %>
			</td>
		</tr>
		<% end %>
	</tbody>
</table>

<%= paginate @static_pages %>


